<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Viviana Romero Alarcon">

<title>Body Mass in Non-avian Dinosaurs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Analysis_files/libs/quarto-html/quarto.js"></script>
<script src="Analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Body Mass in Non-avian Dinosaurs</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Viviana Romero Alarcon </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(caret,tidyverse,dplyr,readr, ggplot2, broom, performance, here)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(here<span class="sc">::</span><span class="fu">here</span>())</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># read data</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"DataBase231129.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 5955 Columns: 29
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(13): Clade.1, Clade.2, Clade.3, Sec_Ref, Primary_Ref, Method, Taxon, EB... dbl
(16): BM.g, Pneumatic, HumerusLen, HumerusCirc, FemurCirc, FemurLen, Tib...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `coracoid_HAF_(mm)` -&gt; `coracoid_HAF_(mm)...27`
• `coracoid_HAF_(mm)` -&gt; `coracoid_HAF_(mm)...28`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">filter</span>(Sec_Ref <span class="sc">!=</span> <span class="st">"Brinkworth_et_al_2023"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I will explore how the distribution looks in each variables: Body mass, Femur circumference and Femur Length</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Clade.1"                "Clade.2"                "Clade.3"               
 [4] "Sec_Ref"                "Primary_Ref"            "Method"                
 [7] "Taxon"                  "EBM.ref.sp"             "Aves"                  
[10] "BM.g"                   "Pneumatic"              "BM.Qual"               
[13] "Meas.sp"                "HumerusLen"             "HumerusCirc"           
[16] "FemurCirc"              "FemurLen"               "TibulaLen"             
[19] "TibiaCirc"              "TarsusLen"              "TarusCirc"             
[22] "Sex"                    "Comments"               "Living"                
[25] "humerus_diameter_(mm)"  "tarsus_diameter_(mm)"   "coracoid_HAF_(mm)...27"
[28] "coracoid_HAF_(mm)...28" "coracoid_max_length"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>distributions <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Clade<span class="fl">.1</span>, Clade<span class="fl">.2</span>, Taxon, Aves,BM.g, FemurCirc, FemurLen, Aves, Living) <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(FemurCirc, FemurLen), <span class="at">names_to =</span> <span class="st">"Covars"</span>,<span class="at">values_to =</span> <span class="st">"vals"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Femur lenght distribution</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(distributions, <span class="fu">aes</span>(<span class="at">x =</span> vals, <span class="at">y =</span> BM.g)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>( <span class="at">color =</span> Clade<span class="fl">.1</span>, <span class="at">shape =</span> <span class="fu">as.factor</span>(Living)), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Aves <span class="sc">~</span> Covars, <span class="at">scales =</span> <span class="st">'free'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1272 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="femur-circumference-prediction" class="level3">
<h3 class="anchored" data-anchor-id="femur-circumference-prediction">Femur Circumference prediction</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data to use: </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Clade.1"                "Clade.2"                "Clade.3"               
 [4] "Sec_Ref"                "Primary_Ref"            "Method"                
 [7] "Taxon"                  "EBM.ref.sp"             "Aves"                  
[10] "BM.g"                   "Pneumatic"              "BM.Qual"               
[13] "Meas.sp"                "HumerusLen"             "HumerusCirc"           
[16] "FemurCirc"              "FemurLen"               "TibulaLen"             
[19] "TibiaCirc"              "TarsusLen"              "TarusCirc"             
[22] "Sex"                    "Comments"               "Living"                
[25] "humerus_diameter_(mm)"  "tarsus_diameter_(mm)"   "coracoid_HAF_(mm)...27"
[28] "coracoid_HAF_(mm)...28" "coracoid_max_length"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>avesFCFL <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">filter</span>( Aves <span class="sc">==</span> <span class="st">"Y"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(FemurCirc) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(FemurLen))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Training and testing sets</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>sample.test <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(avesFCFL),<span class="at">size =</span> <span class="fu">ceiling</span>(<span class="fu">nrow</span>(avesFCFL)<span class="sc">*</span> <span class="fl">0.2</span>)),<span class="fu">which</span>(avesFCFL<span class="sc">$</span>Clade<span class="fl">.2</span> <span class="sc">==</span><span class="st">"Sphenisciformes"</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>avesFCFL.test <span class="ot">&lt;-</span> avesFCFL[sample.test,]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>avesFCFL.train <span class="ot">&lt;-</span> avesFCFL[<span class="sc">-</span><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(avesFCFL),<span class="at">size =</span> <span class="fu">ceiling</span>(<span class="fu">nrow</span>(avesFCFL)<span class="sc">*</span> <span class="fl">0.2</span>)),]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Femur Circumference distribution</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avesFCFL) <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="fu">aes</span>( <span class="at">x=</span>FemurCirc, <span class="at">fill=</span> Clade<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Femur Length distribution</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avesFCFL) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="fu">aes</span>( <span class="at">x=</span>FemurLen, <span class="at">fill=</span> Clade<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot FC ~ FL</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avesFCFL, <span class="fu">aes</span>(<span class="at">x=</span>FemurLen, <span class="at">y=</span>FemurCirc)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span> Clade<span class="fl">.1</span>, <span class="at">shape =</span> <span class="fu">as.factor</span>(Living)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fitting-models" class="level2">
<h2 class="anchored" data-anchor-id="fitting-models">Fitting models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit lineal model</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>lm_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(FemurCirc <span class="sc">~</span> FemurLen, <span class="at">data =</span> avesFCFL.train)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit loglog model</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>loglog_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(FemurCirc) <span class="sc">~</span> <span class="fu">log</span>(FemurLen), <span class="at">data =</span> avesFCFL.train)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple linear regression Clade 1</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>lmClade1_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(FemurCirc <span class="sc">~</span> FemurLen <span class="sc">+</span> Clade<span class="fl">.1</span>, <span class="at">data =</span> avesFCFL.train)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple loglog linear regression Clade 1</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>logClade1_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(FemurCirc) <span class="sc">~</span> <span class="fu">log</span>(FemurLen) <span class="sc">+</span> Clade<span class="fl">.1</span>, <span class="at">data =</span> avesFCFL.train)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple linear regression Clade 2</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>lmClade2_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(FemurCirc <span class="sc">~</span> FemurLen <span class="sc">+</span> Clade<span class="fl">.2</span>, <span class="at">data =</span> avesFCFL.train)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple loglog linear regression Clade 2</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>logClade2_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(FemurCirc) <span class="sc">~</span> <span class="fu">log</span>(FemurLen) <span class="sc">+</span> Clade<span class="fl">.2</span>, <span class="at">data =</span> avesFCFL.train)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly model </span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>poly2_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(FemurCirc <span class="sc">~</span> <span class="fu">poly</span>(FemurLen,<span class="dv">2</span>), <span class="at">data =</span> avesFCFL.train)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple Poly model Clade 1</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>poly2Clade1_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(FemurCirc <span class="sc">~</span> <span class="fu">poly</span>(FemurLen,<span class="dv">2</span>) <span class="sc">+</span> Clade<span class="fl">.1</span> , <span class="at">data =</span> avesFCFL.train)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple Poly model Clade 2</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>poly2Clade2_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(FemurCirc <span class="sc">~</span> <span class="fu">poly</span>(FemurLen,<span class="dv">2</span>) <span class="sc">+</span> Clade<span class="fl">.2</span>, <span class="at">data =</span> avesFCFL.train)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">AIC</span>(lm_FC, lmClade1_FC, lmClade2_FC, loglog_FC,logClade1_FC, logClade2_FC, poly2_FC, poly2Clade1_FC,poly2Clade2_FC ), <span class="at">adjR2 =</span> <span class="fu">c</span>(<span class="fl">0.9243</span>, <span class="fl">0.9243</span>, <span class="fl">0.96</span>,<span class="fl">0.9685</span>, <span class="fl">0.9701</span>, <span class="fl">0.9849</span>, <span class="fl">0.9712</span>, <span class="fl">0.9712</span>,<span class="fl">0.9794</span> ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               df        AIC  adjR2
lm_FC           3  6701.4426 0.9243
lmClade1_FC     4  6699.7569 0.9243
lmClade2_FC    34  6085.5970 0.9600
loglog_FC       3  -679.5896 0.9685
logClade1_FC    4  -720.6445 0.9701
logClade2_FC   34 -1325.3984 0.9849
poly2_FC        4  5811.1196 0.9712
poly2Clade1_FC  5  5812.9340 0.9712
poly2Clade2_FC 35  5495.0246 0.9794</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poly2Clade2_FC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = FemurCirc ~ poly(FemurLen, 2) + Clade.2, data = avesFCFL.train)

Residuals:
    Min      1Q  Median      3Q     Max 
-41.679  -0.906  -0.019   0.730  40.780 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 18.98904    0.75942  25.005  &lt; 2e-16 ***
poly(FemurLen, 2)1         915.93822    8.98897 101.896  &lt; 2e-16 ***
poly(FemurLen, 2)2         185.09488    6.55812  28.224  &lt; 2e-16 ***
Clade.2Aepyornithiformes    16.88209    3.49010   4.837 1.55e-06 ***
Clade.2Anseriformes          5.16190    0.85273   6.053 2.08e-09 ***
Clade.2Apodiformes           1.42195    1.38814   1.024 0.305940    
Clade.2Apterygiformes        2.22045    2.67786   0.829 0.407218    
Clade.2Caprimulgiformes      1.11544    1.88224   0.593 0.553588    
Clade.2Cariamiformes        -9.47635    4.53792  -2.088 0.037054 *  
Clade.2Casuariiformes       -1.32556    1.57887  -0.840 0.401375    
Clade.2Charadriiformes       1.58125    0.87503   1.807 0.071081 .  
Clade.2Ciconiiformes        -2.36240    1.02289  -2.310 0.021139 *  
Clade.2Columbiformes         0.97976    1.11316   0.880 0.379008    
Clade.2Coraciiformes         1.97627    1.62439   1.217 0.224066    
Clade.2Cuculiformes          2.36397    2.69073   0.879 0.379873    
Clade.2Dinornithiformes      8.35232    1.42430   5.864 6.33e-09 ***
Clade.2Dinornitiformes      18.29635    4.70721   3.887 0.000109 ***
Clade.2Falconiformes         0.59815    1.33767   0.447 0.654865    
Clade.2Galliformes          -1.26161    0.94426  -1.336 0.181862    
Clade.2Gastornithiformes   -12.74698    4.77890  -2.667 0.007782 ** 
Clade.2Gruiformes           -0.78200    0.85742  -0.912 0.361990    
Clade.2Passeriformes         1.03247    0.92424   1.117 0.264244    
Clade.2Pelecaniformes        4.42938    2.34579   1.888 0.059316 .  
Clade.2Phoenicopteriformes   3.58784    4.51711   0.794 0.427242    
Clade.2Podicipediformes      7.17462    1.39158   5.156 3.10e-07 ***
Clade.2Procellariiformes     2.17668    1.22764   1.773 0.076556 .  
Clade.2Psittaciformes        1.17156    1.21599   0.963 0.335572    
Clade.2Rheiformes          -16.07743    2.07647  -7.743 2.61e-14 ***
Clade.2Sphenisciformes       4.02534    4.51727   0.891 0.373112    
Clade.2Strigiformes         -0.82871    1.15628  -0.717 0.473739    
Clade.2Struthioniformes    -13.36836    2.96019  -4.516 7.14e-06 ***
Clade.2Suliformes            6.73331    1.40095   4.806 1.80e-06 ***
Clade.2Tinamiformes          0.09076    2.35212   0.039 0.969227    
Clade.2Trogoniformes         2.86859    2.70579   1.060 0.289353    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.457 on 903 degrees of freedom
Multiple R-squared:  0.9805,    Adjusted R-squared:  0.9798 
F-statistic:  1376 on 33 and 903 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit values</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>fitvals_FC.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> avesFCFL.train<span class="sc">$</span>FemurLen, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">trueFC =</span> avesFCFL.train<span class="sc">$</span>FemurCirc,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">lm_FC =</span> lm_FC<span class="sc">$</span>fitted.values, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">loglog_FC =</span> <span class="fu">exp</span>(loglog_FC<span class="sc">$</span>fitted.values),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">lmClade1_FC =</span> lmClade1_FC<span class="sc">$</span>fitted.values,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">logClade1_FC =</span> <span class="fu">exp</span>(logClade1_FC<span class="sc">$</span>fitted.values),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">lmClade2_FC =</span> lmClade2_FC<span class="sc">$</span>fitted.values,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">logClade2_FC =</span> <span class="fu">exp</span>(logClade2_FC<span class="sc">$</span>fitted.values),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">poly2_FC =</span> poly2_FC<span class="sc">$</span>fitted.values,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">poly2Clade1_FC =</span> poly2Clade1_FC<span class="sc">$</span>fitted.values,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">poly2Clade2_FC =</span> poly2Clade2_FC<span class="sc">$</span>fitted.values)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>fitvals_FC.long <span class="ot">&lt;-</span> fitvals_FC.train <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>FemurLen, <span class="at">names_to =</span> <span class="st">'model'</span>, <span class="at">values_to =</span> <span class="st">'FemurCirc'</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fitvals_FC.long) <span class="sc">+</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> FemurLen, <span class="at">y =</span> FemurCirc, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> avesFCFL.train, <span class="fu">aes</span>(<span class="at">x=</span>FemurLen, <span class="at">y=</span>FemurCirc), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">'darkblue'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Estimating MSE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(avesFCFL.train<span class="sc">$</span>FemurLen)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>lm_FC.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.train<span class="sc">$</span>FemurCirc <span class="sc">-</span> lm_FC<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>loglog_FC.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">log</span>(avesFCFL.train<span class="sc">$</span>FemurCirc) <span class="sc">-</span> loglog_FC<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>lmClade1_FC.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.train<span class="sc">$</span>FemurCirc <span class="sc">-</span> lmClade1_FC<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>logClade1_FC.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">log</span>(avesFCFL.train<span class="sc">$</span>FemurCirc) <span class="sc">-</span> logClade1_FC<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>lmClade2_FC.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.train<span class="sc">$</span>FemurCirc <span class="sc">-</span> lmClade2_FC<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>logClade2_FC.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">log</span>(avesFCFL.train<span class="sc">$</span>FemurCirc) <span class="sc">-</span> logClade2_FC<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>poly2_FC.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.train<span class="sc">$</span>FemurCirc <span class="sc">-</span> poly2_FC<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>poly2Clade1_FC.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.train<span class="sc">$</span>FemurCirc <span class="sc">-</span> poly2Clade1_FC<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>poly2Clade2_FC.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.train<span class="sc">$</span>FemurCirc <span class="sc">-</span> poly2Clade2_FC<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>MSE.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">type =</span> <span class="st">'train'</span>, <span class="at">lm_FC =</span> lm_FC.MSE.train, </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">loglog_FC =</span>loglog_FC.MSE.train,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lmClade1_FC =</span> lmClade1_FC.MSE.train,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">logClade1_FC =</span> logClade1_FC.MSE.train,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lmClade2_FC =</span> lmClade2_FC.MSE.train,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">logClade2_FC =</span> logClade2_FC.MSE.train,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2_FC =</span>poly2_FC.MSE.train,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2Clade1_FC =</span> poly2Clade1_FC.MSE.train,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2Clade2_FC =</span> poly2Clade2_FC.MSE.train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="prediction-test-dataset" class="level3">
<h3 class="anchored" data-anchor-id="prediction-test-dataset">Prediction: test dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lm_FC.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_FC, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> avesFCFL.test<span class="sc">$</span>FemurLen))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>loglog_FC.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(loglog_FC, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> <span class="fu">log</span>(avesFCFL.test<span class="sc">$</span>FemurLen)))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>lmClade1_FC.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmClade1_FC, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> avesFCFL.test<span class="sc">$</span>FemurLen,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Clade.1=</span> avesFCFL.test<span class="sc">$</span>Clade<span class="fl">.1</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>logClade1_FC.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(logClade1_FC, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> <span class="fu">log</span>(avesFCFL.test<span class="sc">$</span>FemurLen),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Clade.1=</span> avesFCFL.test<span class="sc">$</span>Clade<span class="fl">.1</span>))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>lmClade2_FC.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmClade2_FC, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> avesFCFL.test<span class="sc">$</span>FemurLen,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Clade.2=</span> avesFCFL.test<span class="sc">$</span>Clade<span class="fl">.2</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>logClade2_FC.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(logClade2_FC, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> <span class="fu">log</span>(avesFCFL.test<span class="sc">$</span>FemurLen),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Clade.2=</span> avesFCFL.test<span class="sc">$</span>Clade<span class="fl">.2</span>))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>poly2_FC.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(poly2_FC, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> avesFCFL.test<span class="sc">$</span>FemurLen))</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>poly2Clade1_FC.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(poly2Clade1_FC, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> avesFCFL.test<span class="sc">$</span>FemurLen,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Clade.1=</span> avesFCFL.test<span class="sc">$</span>Clade<span class="fl">.1</span>))</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>poly2Clade2_FC.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(poly2Clade2_FC, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurLen =</span> avesFCFL.test<span class="sc">$</span>FemurLen,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Clade.2=</span> avesFCFL.test<span class="sc">$</span>Clade<span class="fl">.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mean-standard-error-training-vr-test" class="level3">
<h3 class="anchored" data-anchor-id="mean-standard-error-training-vr-test">Mean Standard Error Training vr Test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(avesFCFL.test<span class="sc">$</span>FemurLen)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>lm_FC.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.test<span class="sc">$</span>FemurCirc <span class="sc">-</span> lm_FC.prd)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>loglog_FC.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">log</span>(avesFCFL.test<span class="sc">$</span>FemurCirc) <span class="sc">-</span> loglog_FC.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>lmClade1_FC.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.test<span class="sc">$</span>FemurCirc <span class="sc">-</span> lmClade1_FC.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>logClade1_FC.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">log</span>(avesFCFL.test<span class="sc">$</span>FemurCirc) <span class="sc">-</span> logClade1_FC.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>lmClade2_FC.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.test<span class="sc">$</span>FemurCirc <span class="sc">-</span> lmClade2_FC.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>logClade2_FC.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">log</span>(avesFCFL.test<span class="sc">$</span>FemurCirc) <span class="sc">-</span> logClade2_FC.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>poly2_FC.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.test<span class="sc">$</span>FemurCirc <span class="sc">-</span> poly2_FC.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>poly2Clade1_FC.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.test<span class="sc">$</span>FemurCirc <span class="sc">-</span> poly2Clade1_FC.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>poly2Clade2_FC.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCFL.test<span class="sc">$</span>FemurCirc <span class="sc">-</span> poly2Clade2_FC.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>MSE.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">type =</span> <span class="st">'test'</span>, <span class="at">lm_FC =</span> lm_FC.MSE.test, </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">loglog_FC =</span> loglog_FC.MSE.test,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lmClade1_FC =</span> lmClade1_FC.MSE.test,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">logClade1_FC =</span> logClade1_FC.MSE.test,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lmClade2_FC =</span> lmClade2_FC.MSE.test,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">logClade2_FC =</span> logClade2_FC.MSE.test,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2_FC =</span> poly2_FC.MSE.test,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2Clade1_FC =</span> poly2Clade1_FC.MSE.test,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2Clade2_FC =</span> poly2Clade2_FC.MSE.test)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MSE.train, MSE.test)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>MSE </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   type    lm_FC  loglog_FC lmClade1_FC logClade1_FC lmClade2_FC logClade2_FC
1 train 74.27240 0.02816816    73.98082   0.02690313    36.02879   0.01323406
2  test 78.07492 8.92702669    77.37059   8.51264471    37.01244   7.98300159
  poly2_FC poly2Clade1_FC poly2Clade2_FC
1 28.65764       28.65197       19.14236
2 23.79504       23.89834       18.79472</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>MSE.long <span class="ot">&lt;-</span> MSE <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>type, <span class="at">names_to =</span> <span class="st">'model'</span>, <span class="at">values_to =</span> <span class="st">'MSE'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(MSE.long<span class="sc">$</span>model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "lm_FC"          "lmClade1_FC"    "lmClade2_FC"    "logClade1_FC"  
[5] "logClade2_FC"   "loglog_FC"      "poly2_FC"       "poly2Clade1_FC"
[9] "poly2Clade2_FC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a> MSE.long<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">factor</span>(MSE.long<span class="sc">$</span>model, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"lm_FC"</span>,<span class="st">"lmClade1_FC"</span>,<span class="st">"lmClade2_FC"</span>,<span class="st">"loglog_FC"</span>,<span class="st">"logClade1_FC"</span>,<span class="st">"logClade2_FC"</span>,<span class="st">"poly2_FC"</span>,<span class="st">"poly2Clade1_FC"</span>,<span class="st">"poly2Clade2_FC"</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> MSE.long, <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> MSE)) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> type, <span class="at">color =</span> type) )<span class="sc">+</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="repeated-k-fold-cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="repeated-k-fold-cross-validation">Repeated k-fold Cross Validation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No test dataset is necessary</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>train.control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">number =</span> <span class="dv">20</span>, <span class="at">repeats =</span> <span class="dv">10</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit lineal model</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>lm_FC <span class="ot">&lt;-</span> <span class="fu">train</span>(FemurCirc <span class="sc">~</span> FemurLen, <span class="at">data =</span> avesFCFL, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit loglog model</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>loglog_FC <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">log</span>(FemurCirc) <span class="sc">~</span> <span class="fu">log</span>(FemurLen), <span class="at">data =</span> avesFCFL, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple linear regression Clade 1</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>lmClade1_FC <span class="ot">&lt;-</span> <span class="fu">train</span>(FemurCirc <span class="sc">~</span> FemurLen <span class="sc">+</span> Clade<span class="fl">.1</span>,<span class="at">data =</span> avesFCFL, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple loglog linear regression Clade 1</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>logClade1_FC <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">log</span>(FemurCirc) <span class="sc">~</span> <span class="fu">log</span>(FemurLen) <span class="sc">+</span> Clade<span class="fl">.1</span>, <span class="at">data =</span> avesFCFL, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple linear regression Clade 2</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>lmClade2_FC <span class="ot">&lt;-</span> <span class="fu">train</span>(FemurCirc <span class="sc">~</span> FemurLen <span class="sc">+</span> Clade<span class="fl">.2</span>, <span class="at">data =</span> avesFCFL, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple loglog linear regression Clade 2</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>logClade2_FC <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">log</span>(FemurCirc) <span class="sc">~</span> <span class="fu">log</span>(FemurLen) <span class="sc">+</span> Clade<span class="fl">.2</span>, <span class="at">data =</span> avesFCFL, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly model </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>poly2_FC <span class="ot">&lt;-</span> <span class="fu">train</span>(FemurCirc <span class="sc">~</span> <span class="fu">poly</span>(FemurLen,<span class="dv">2</span>), <span class="at">data =</span> avesFCFL, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple Poly model Clade 1</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>poly2Clade1_FC <span class="ot">&lt;-</span> <span class="fu">train</span>(FemurCirc <span class="sc">~</span> <span class="fu">poly</span>(FemurLen,<span class="dv">2</span>) <span class="sc">+</span> Clade<span class="fl">.1</span> , <span class="at">data =</span> avesFCFL, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple Poly model Clade 2</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>poly2Clade2_FC <span class="ot">&lt;-</span> <span class="fu">train</span>(FemurCirc <span class="sc">~</span> <span class="fu">poly</span>(FemurLen,<span class="dv">2</span>) <span class="sc">+</span> Clade<span class="fl">.2</span>, <span class="at">data =</span> avesFCFL, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading

Warning in predict.lm(modelFit, newdata): prediction from a rank-deficient fit
may be misleading</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">type =</span> <span class="st">'cv'</span>, <span class="at">lm_FC =</span> lm_FC<span class="sc">$</span>results<span class="sc">$</span>MAE, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">loglog_FC =</span> loglog_FC<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lmClade1_FC =</span> lmClade1_FC<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">logClade1_FC =</span> logClade1_FC<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">lmClade2_FC =</span> lmClade2_FC<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">logClade2_FC =</span> logClade2_FC<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2_FC =</span> poly2_FC<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2Clade1_FC =</span> poly2Clade1_FC<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2Clade2_FC =</span> poly2Clade2_FC<span class="sc">$</span>results<span class="sc">$</span>MAE)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>MAE.long <span class="ot">&lt;-</span> MAE <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>type, <span class="at">names_to =</span> <span class="st">'model'</span>, <span class="at">values_to =</span> <span class="st">'MAE'</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> MAE.long, <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> MAE)) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> type, <span class="at">color =</span> type) )<span class="sc">+</span> </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="selecting-model" class="level1">
<h1>Selecting model</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check model selected </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>logClade2_FC <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(FemurCirc) <span class="sc">~</span> <span class="fu">log</span>(FemurLen) , <span class="at">data =</span> avesFCFL)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logClade2_FC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(FemurCirc) ~ log(FemurLen), data = avesFCFL)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45961 -0.10700 -0.01649  0.09030  0.61309 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -2.039030   0.024978  -81.63   &lt;2e-16 ***
log(FemurLen)  1.206006   0.006519  185.00   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1687 on 1170 degrees of freedom
Multiple R-squared:  0.9669,    Adjusted R-squared:  0.9669 
F-statistic: 3.423e+04 on 1 and 1170 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(logClade2_FC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>poly2_FC<span class="ot">&lt;-</span> <span class="fu">lm</span>(FemurCirc <span class="sc">~</span> <span class="fu">poly</span>(FemurLen,<span class="dv">2</span>) , <span class="at">data =</span> avesFCFL)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poly2_FC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = FemurCirc ~ poly(FemurLen, 2), data = avesFCFL)

Residuals:
    Min      1Q  Median      3Q     Max 
-39.466  -1.082  -0.497   1.134  43.820 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          20.3567     0.1588  128.21   &lt;2e-16 ***
poly(FemurLen, 2)1 1040.6600     5.4355  191.46   &lt;2e-16 ***
poly(FemurLen, 2)2  229.4403     5.4355   42.21   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.436 on 1169 degrees of freedom
Multiple R-squared:  0.9705,    Adjusted R-squared:  0.9704 
F-statistic: 1.922e+04 on 2 and 1169 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(poly2_FC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>poly2Clade2_FC<span class="ot">&lt;-</span> <span class="fu">lm</span>(FemurCirc <span class="sc">~</span> <span class="fu">poly</span>(FemurLen,<span class="dv">2</span>) <span class="sc">+</span> Clade<span class="fl">.2</span> , <span class="at">data =</span> avesFCFL)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poly2Clade2_FC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = FemurCirc ~ poly(FemurLen, 2) + Clade.2, data = avesFCFL)

Residuals:
    Min      1Q  Median      3Q     Max 
-46.114  -0.873  -0.022   0.721  36.446 

Coefficients:
                             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                  19.10452    0.64724  29.517  &lt; 2e-16 ***
poly(FemurLen, 2)1         1052.25794    8.84923 118.910  &lt; 2e-16 ***
poly(FemurLen, 2)2          209.82305    6.26650  33.483  &lt; 2e-16 ***
Clade.2Aepyornithiformes     13.02246    2.55863   5.090 4.19e-07 ***
Clade.2Anseriformes           5.07672    0.73174   6.938 6.67e-12 ***
Clade.2Apodiformes            1.51187    1.18096   1.280 0.200735    
Clade.2Apterygiformes         1.64946    2.32194   0.710 0.477614    
Clade.2Caprimulgiformes       1.17337    1.65420   0.709 0.478268    
Clade.2Cariamiformes        -10.39774    4.52849  -2.296 0.021853 *  
Clade.2Casuariiformes        -2.96133    1.36725  -2.166 0.030525 *  
Clade.2Charadriiformes        1.51542    0.74923   2.023 0.043346 *  
Clade.2Ciconiiformes         -2.44600    0.87231  -2.804 0.005132 ** 
Clade.2Columbiformes          0.99771    1.00988   0.988 0.323387    
Clade.2Coraciiformes          2.62215    1.30549   2.009 0.044819 *  
Clade.2Cuculiformes           2.39980    2.66464   0.901 0.367985    
Clade.2Dinornithiformes       5.91263    1.30726   4.523 6.74e-06 ***
Clade.2Dinornitiformes       14.17020    4.65533   3.044 0.002389 ** 
Clade.2Falconiformes          0.41039    1.18087   0.348 0.728255    
Clade.2Galliformes           -1.45771    0.83581  -1.744 0.081418 .  
Clade.2Gastornithiformes    -17.53971    4.70882  -3.725 0.000205 ***
Clade.2Gruiformes            -0.85912    0.75247  -1.142 0.253804    
Clade.2Passeriformes          1.12666    0.79614   1.415 0.157300    
Clade.2Pelecaniformes         4.25683    2.31939   1.835 0.066718 .  
Clade.2Phoenicopteriformes    5.07465    3.22163   1.575 0.115493    
Clade.2Podicipediformes       7.35473    1.24659   5.900 4.79e-09 ***
Clade.2Procellariiformes      2.31751    1.08574   2.134 0.033016 *  
Clade.2Psittaciformes         1.22413    1.09100   1.122 0.262087    
Clade.2Rheiformes           -17.66068    1.89797  -9.305  &lt; 2e-16 ***
Clade.2Sphenisciformes        3.80752    4.51100   0.844 0.398818    
Clade.2Strigiformes          -0.69410    1.00963  -0.687 0.491922    
Clade.2Struthioniformes     -18.48689    2.37096  -7.797 1.42e-14 ***
Clade.2Suliformes             7.31367    1.25308   5.837 6.94e-09 ***
Clade.2Tinamiformes           0.09431    2.09714   0.045 0.964138    
Clade.2Trogoniformes          2.75662    2.34662   1.175 0.240353    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.467 on 1138 degrees of freedom
Multiple R-squared:  0.9806,    Adjusted R-squared:   0.98 
F-statistic:  1743 on 33 and 1138 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(poly2Clade2_FC)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(logClade2_FC, poly2_FC, poly2Clade2_FC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               df       AIC
logClade2_FC    3 -841.5434
poly2_FC        4 7299.2862
poly2Clade2_FC 35 6869.6171</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avesFCFL, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(FemurLen)))<span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span> <span class="fu">log</span>(BM.g), <span class="at">color =</span> Clade<span class="fl">.2</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y=</span> <span class="fu">log</span>(BM.g)), <span class="at">method =</span> <span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 148 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 148 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="predicting-femur-circumference" class="level3">
<h3 class="anchored" data-anchor-id="predicting-femur-circumference">Predicting Femur circumference</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(avesFCFL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1172   29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(avesFCFL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Clade.1"                "Clade.2"                "Clade.3"               
 [4] "Sec_Ref"                "Primary_Ref"            "Method"                
 [7] "Taxon"                  "EBM.ref.sp"             "Aves"                  
[10] "BM.g"                   "Pneumatic"              "BM.Qual"               
[13] "Meas.sp"                "HumerusLen"             "HumerusCirc"           
[16] "FemurCirc"              "FemurLen"               "TibulaLen"             
[19] "TibiaCirc"              "TarsusLen"              "TarusCirc"             
[22] "Sex"                    "Comments"               "Living"                
[25] "humerus_diameter_(mm)"  "tarsus_diameter_(mm)"   "coracoid_HAF_(mm)...27"
[28] "coracoid_HAF_(mm)...28" "coracoid_max_length"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>clde <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">as.factor</span>(avesFCFL<span class="sc">$</span>Clade<span class="fl">.2</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Aves <span class="sc">==</span> <span class="st">"Y"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(FemurCirc) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(FemurLen) <span class="sc">&amp;</span> <span class="fu">as.factor</span>(Clade<span class="fl">.2</span>) <span class="sc">%in%</span> clde) </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">#pred &lt;- data |&gt; </span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(Aves == "Y" &amp; is.na(FemurCirc) &amp; !is.na(FemurLen)) </span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>data6 <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(data,pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Clade.1, Clade.2, Clade.3, Sec_Ref, Primary_Ref,
Method, Taxon, EBM.ref.sp, Aves, BM.g, Pneumatic, BM.Qual, Meas.sp, HumerusLen,
HumerusCirc, FemurCirc, FemurLen, TibulaLen, TibiaCirc, TarsusLen, TarusCirc,
Sex, Comments, Living, `humerus_diameter_(mm)`, `tarsus_diameter_(mm)`,
`coracoid_HAF_(mm)...27`, `coracoid_HAF_(mm)...28`, coracoid_max_length)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">predict</span>(logClade2_FC, <span class="at">newdata =</span> pred[,<span class="fu">c</span>(<span class="st">"FemurLen"</span>, <span class="st">"Clade.2"</span>)])),<span class="dv">2</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> pred <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">FemurCirc =</span> predictions, <span class="at">typeFC =</span> <span class="fu">rep</span>(<span class="st">"Predicted"</span>,<span class="fu">nrow</span>(pred))) </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>data6 <span class="ot">&lt;-</span> data6 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">typeFC =</span> <span class="fu">rep</span>(<span class="st">"Observation"</span>,<span class="fu">nrow</span>(data6)))</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data6,pred2)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avesFCFL)<span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> , <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(FemurLen), <span class="at">y=</span><span class="fu">log</span>(FemurCirc), <span class="at">color =</span> Clade<span class="fl">.2</span>),</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pred2,<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(FemurLen), <span class="at">y=</span><span class="fu">log</span>(FemurCirc), <span class="at">color =</span> Clade<span class="fl">.2</span>), <span class="at">size =</span> <span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="predicting-body-mass" class="level1">
<h1>Predicting Body Mass</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(new<span class="sc">$</span>Sec_Ref))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Campione_&amp;_Evans_2020"      "Campione_et_al_(2014)"     
[3] "Canoville_etal_(2022)"      "Chadwick_et_al_(2014)"     
[5] "Chan_(2017)"                "Crouch&amp;Clarke_(2019)"      
[7] "Elzanowski&amp;Louchart_(2022)" "Field_et_al_(2013)"        
[9] "Gatesy&amp;Middleton_(1997)"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>newAves <span class="ot">&lt;-</span>new <span class="sc">|&gt;</span> <span class="fu">filter</span>(Aves <span class="sc">==</span> <span class="st">"Y"</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Ref =</span> <span class="fu">ifelse</span>( Sec_Ref <span class="sc">==</span> <span class="st">"Campione_et_al_(2014)"</span>, <span class="st">"Campione_et_al_2014"</span>, <span class="fu">ifelse</span>( Sec_Ref <span class="sc">==</span> <span class="st">"Field_et_al_(2013)"</span>,<span class="st">"Field_et_al_2013"</span>, <span class="fu">ifelse</span>( typeFC <span class="sc">==</span> <span class="st">"Predicted"</span>, <span class="st">"NewSource"</span>, <span class="st">"NewSource"</span>)))) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(BM.g) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(FemurCirc))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot FC ~ FL</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(newAves, <span class="fu">aes</span>(<span class="at">x =</span> FemurCirc, <span class="at">y =</span> BM.g)) <span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>( <span class="at">color =</span> Ref, <span class="at">shape =</span> Clade<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Ref <span class="sc">~</span> .)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(newAves, <span class="fu">aes</span>(<span class="at">x =</span> FemurCirc, <span class="at">y =</span> BM.g)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>( <span class="at">color =</span> Ref, <span class="at">shape =</span> Clade<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Clade<span class="fl">.1</span> <span class="sc">~</span> .)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(new , <span class="fu">aes</span>(<span class="at">x =</span> FemurCirc, <span class="at">y =</span> BM.g)) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(  <span class="at">color =</span> Clade<span class="fl">.1</span>, <span class="at">shape =</span>Method)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Aves<span class="sc">~</span>., <span class="at">scales =</span> <span class="st">'free'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 553 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The shape palette can deal with a maximum of 6 discrete values because
more than 6 becomes difficult to discriminate; you have 7. Consider
specifying shapes manually if you must have them.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 583 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Femur Circumference distribution</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(newAves) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="fu">aes</span>( <span class="at">x=</span>FemurCirc, <span class="at">fill=</span> Clade<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Femur Length distribution</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(newAves) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="fu">aes</span>( <span class="at">x=</span>BM.g, <span class="at">fill=</span> Clade<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-11-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="datasets" class="level3">
<h3 class="anchored" data-anchor-id="datasets">datasets</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training and testing sets</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>sample.test <span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(newAves),<span class="at">size =</span> <span class="fu">ceiling</span>(<span class="fu">nrow</span>(newAves)<span class="sc">*</span> <span class="fl">0.2</span>))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>avesFCBM.test <span class="ot">&lt;-</span> newAves[sample.test,]</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>avesFCBM.train <span class="ot">&lt;-</span> newAves[<span class="sc">-</span>sample.test,]</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">dim</span>(avesFCBM.train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 828  31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit lineal model</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>lm_BM <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span>FemurCirc, <span class="at">data =</span> avesFCBM.train)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit loglog model</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>loglog_BM <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(BM.g) <span class="sc">~</span> <span class="fu">log</span>(FemurCirc), <span class="at">data =</span> avesFCBM.train)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly 2 model </span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>poly2_BM <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span> <span class="fu">poly</span>(FemurCirc,<span class="dv">2</span>), <span class="at">data =</span> avesFCBM.train)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly 2 model </span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>poly3_BM <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span> <span class="fu">poly</span>(FemurCirc,<span class="dv">3</span>), <span class="at">data =</span> avesFCBM.train)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Spline model 1 knots</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>Spline_BM1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span><span class="fu">bs</span>(FemurCirc, <span class="at">knots =</span> <span class="dv">50</span>), <span class="at">data =</span> avesFCBM.train)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Spline model 2 knots</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>Spline_BM2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span> <span class="fu">bs</span>(FemurCirc, <span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">50</span>)), <span class="at">data =</span> avesFCBM.train)</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit values</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>fitvals_BM.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">FemurCirc =</span> avesFCBM.train<span class="sc">$</span>FemurCirc, </span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">trueBM =</span> avesFCBM.train<span class="sc">$</span>BM.g,</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">lm_BM =</span> lm_BM<span class="sc">$</span>fitted.values, </span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">loglog_BM =</span> <span class="fu">exp</span>(loglog_BM<span class="sc">$</span>fitted.values),</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">poly2_BM =</span> poly2_BM<span class="sc">$</span>fitted.values,</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">poly3_BM =</span> poly3_BM<span class="sc">$</span>fitted.values,</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Spline_BM1 =</span> Spline_BM1<span class="sc">$</span>fitted.values,</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Spline_BM2 =</span> Spline_BM2<span class="sc">$</span>fitted.values)</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>fitvals_BM.long <span class="ot">&lt;-</span> fitvals_BM.train <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>FemurCirc, <span class="at">names_to =</span> <span class="st">'model'</span>, <span class="at">values_to =</span> <span class="st">'BM'</span>)</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fitvals_BM.long) <span class="sc">+</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> BM, <span class="at">x =</span> FemurCirc, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> avesFCBM.train, <span class="fu">aes</span>(<span class="at">y=</span>BM.g, <span class="at">x=</span>FemurCirc), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">'darkblue'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mse-training-data" class="level3">
<h3 class="anchored" data-anchor-id="mse-training-data">MSE training data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(avesFCBM.train<span class="sc">$</span>BM.g)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>lm_BM.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.train<span class="sc">$</span>BM.g <span class="sc">-</span> lm_BM<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>loglog_BM.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">log</span>(avesFCBM.train<span class="sc">$</span>BM.g) <span class="sc">-</span> loglog_BM<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>poly2_BM.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.train<span class="sc">$</span>BM.g <span class="sc">-</span> poly2_BM<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>poly3_BM.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.train<span class="sc">$</span>BM.g <span class="sc">-</span> poly3_BM<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>Spline_BM1.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.train<span class="sc">$</span>BM.g <span class="sc">-</span> Spline_BM1<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>Spline_BM2.MSE.train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.train<span class="sc">$</span>BM.g <span class="sc">-</span> Spline_BM2<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>MSE.trainBM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">type =</span> <span class="st">'train'</span>, <span class="at">lm_BM =</span> lm_BM.MSE.train, </span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">loglog_BM =</span>loglog_BM.MSE.train,</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2_BM =</span> poly2_BM.MSE.train,</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly3_BM =</span> poly3_BM.MSE.train,</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Spline_BM1 =</span> Spline_BM1.MSE.train,</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Spline_BM2 =</span> Spline_BM2.MSE.train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predictions" class="level3">
<h3 class="anchored" data-anchor-id="predictions">Predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit lineal model</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>lm_BM.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_BM, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurCirc =</span> avesFCBM.test<span class="sc">$</span>FemurCirc))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit loglog model</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>loglog_BM.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(loglog_BM, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurCirc =</span> avesFCBM.test<span class="sc">$</span>FemurCirc))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly 2 model </span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>poly2_BM.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(poly2_BM, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurCirc =</span> avesFCBM.test<span class="sc">$</span>FemurCirc))</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly 3 model </span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>poly3_BM.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(poly3_BM, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurCirc =</span> avesFCBM.test<span class="sc">$</span>FemurCirc))</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Spline model 1 knots</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>Spline_BM1.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(Spline_BM1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurCirc =</span> avesFCBM.test<span class="sc">$</span>FemurCirc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in bs(FemurCirc, degree = 3L, knots = 50, Boundary.knots = c(1.35, :
some 'x' values beyond boundary knots may cause ill-conditioned bases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spline model 2 knots</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Spline_BM2.prd <span class="ot">&lt;-</span> <span class="fu">predict</span>(Spline_BM2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">FemurCirc =</span> avesFCBM.test<span class="sc">$</span>FemurCirc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in bs(FemurCirc, degree = 3L, knots = c(35, 50), Boundary.knots =
c(1.35, : some 'x' values beyond boundary knots may cause ill-conditioned bases</code></pre>
</div>
</div>
</section>
<section id="mse-from-prediction-set" class="level3">
<h3 class="anchored" data-anchor-id="mse-from-prediction-set">MSE from prediction set</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(avesFCBM.test<span class="sc">$</span>BM.g)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>lm_BM.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.test<span class="sc">$</span>BM.g <span class="sc">-</span> lm_BM.prd)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>loglog_BM.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">log</span>(avesFCBM.test<span class="sc">$</span>BM.g) <span class="sc">-</span> loglog_BM.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>poly2_BM.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.test<span class="sc">$</span>BM.g <span class="sc">-</span> poly2_BM.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>poly3_BM.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.test<span class="sc">$</span>BM.g <span class="sc">-</span> poly3_BM.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>Spline_BM1.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.test<span class="sc">$</span>BM.g <span class="sc">-</span> Spline_BM1.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>Spline_BM2.MSE.test <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((avesFCBM.test<span class="sc">$</span>BM.g <span class="sc">-</span> Spline_BM2.prd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>MSE.testBM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">type =</span> <span class="st">'test'</span>, <span class="at">lm_BM =</span> lm_BM.MSE.test, </span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">loglog_BM =</span>loglog_BM.MSE.test,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2_BM =</span> poly2_BM.MSE.test,</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly3_BM =</span> poly3_BM.MSE.test,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Spline_BM1 =</span> Spline_BM1.MSE.test,</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Spline_BM2 =</span> Spline_BM2.MSE.test)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MSE.trainBM, MSE.testBM)</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>MSE.longBM <span class="ot">&lt;-</span> MSE <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>type, <span class="at">names_to =</span> <span class="st">'model'</span>, <span class="at">values_to =</span> <span class="st">'MSE'</span>)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(MSE.long<span class="sc">$</span>model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "lm_FC"          "lmClade1_FC"    "lmClade2_FC"    "loglog_FC"     
[5] "logClade1_FC"   "logClade2_FC"   "poly2_FC"       "poly2Clade1_FC"
[9] "poly2Clade2_FC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a> MSE.long<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">factor</span>(MSE.long<span class="sc">$</span>model, </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"lm_FC"</span>,<span class="st">"lmClade1_FC"</span>,<span class="st">"lmClade2_FC"</span>,<span class="st">"loglog_FC"</span>,<span class="st">"logClade1_FC"</span>,<span class="st">"logClade2_FC"</span>,<span class="st">"poly2_FC"</span>,<span class="st">"poly2Clade1_FC"</span>,<span class="st">"poly2Clade2_FC"</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> MSE.longBM, <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> MSE)) <span class="sc">+</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> type, <span class="at">color =</span> type) )<span class="sc">+</span> </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation">Cross Validation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No test dataset is necessary</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>train.control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">20</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit lineal model</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>lm_BM <span class="ot">&lt;-</span> <span class="fu">train</span>(BM.g <span class="sc">~</span>FemurCirc, <span class="at">data =</span> newAves, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit loglog model</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>loglog_BM <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">log</span>(BM.g) <span class="sc">~</span> <span class="fu">log</span>(FemurCirc), <span class="at">data =</span> newAves, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly 2 model </span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>poly2_BM <span class="ot">&lt;-</span> <span class="fu">train</span>(BM.g <span class="sc">~</span> <span class="fu">poly</span>(FemurCirc,<span class="dv">2</span>), <span class="at">data =</span> newAves, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly 2 model </span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>poly3_BM <span class="ot">&lt;-</span> <span class="fu">train</span>(BM.g <span class="sc">~</span> <span class="fu">poly</span>(FemurCirc,<span class="dv">3</span>), <span class="at">data =</span> newAves, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Spline model 1 knots</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(newAves<span class="sc">$</span>FemurCirc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>Spline_BM1 <span class="ot">&lt;-</span> <span class="fu">train</span>(BM.g <span class="sc">~</span><span class="fu">bs</span>(FemurCirc, <span class="at">knots =</span> <span class="dv">50</span>), <span class="at">data =</span> newAves, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Spline model 2 knots</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>Spline_BM2 <span class="ot">&lt;-</span> <span class="fu">train</span>(BM.g <span class="sc">~</span> <span class="fu">bs</span>(FemurCirc, <span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>)), <span class="at">data =</span> avesFCBM.train, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train.control)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>MAE.BM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">type =</span> <span class="st">'cv'</span>, <span class="at">lm_BM =</span> lm_BM<span class="sc">$</span>results<span class="sc">$</span>MAE, </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">loglog_BM =</span> loglog_BM<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly2_BM =</span> poly2_BM<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">poly3_BM =</span> poly3_BM<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Spline_BM1 =</span> Spline_BM1<span class="sc">$</span>results<span class="sc">$</span>MAE,</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Spline_BM2 =</span> Spline_BM2<span class="sc">$</span>results<span class="sc">$</span>MAE)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>MAE.longBM <span class="ot">&lt;-</span> MAE.BM <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>type, <span class="at">names_to =</span> <span class="st">'model'</span>, <span class="at">values_to =</span> <span class="st">'MAE'</span>)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> MAE.longBM, <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> MAE)) <span class="sc">+</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> type, <span class="at">color =</span> type) )<span class="sc">+</span> </span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit lineal model</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>lm_BM <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span>FemurCirc, <span class="at">data =</span> newAves)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit loglog model</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>loglog_BM <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(BM.g) <span class="sc">~</span> <span class="fu">log</span>(FemurCirc), <span class="at">data =</span> newAves)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly 2 model </span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>poly2_BM <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span> <span class="fu">poly</span>(FemurCirc,<span class="dv">2</span>), <span class="at">data =</span> newAves)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Poly 2 model </span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>poly3_BM <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span> <span class="fu">poly</span>(FemurCirc,<span class="dv">3</span>), <span class="at">data =</span> newAves)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Spline model 1 knots</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>Spline_BM1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span><span class="fu">bs</span>(FemurCirc, <span class="at">knots =</span> <span class="dv">50</span>), <span class="at">data =</span> newAves)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Spline model 2 knots</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>Spline_BM2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BM.g <span class="sc">~</span> <span class="fu">bs</span>(FemurCirc, <span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">50</span>)), <span class="at">data =</span> newAves)</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(lm_BM,loglog_BM,poly2_BM,poly3_BM,Spline_BM1,Spline_BM2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           df       AIC
lm_BM       3 20472.316
loglog_BM   3  1005.312
poly2_BM    4 17316.451
poly3_BM    5 17164.744
Spline_BM1  6 17126.734
Spline_BM2  7 17119.403</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Spline_BM2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BM.g ~ bs(FemurCirc, knots = c(35, 50)), data = newAves)

Residuals:
     Min       1Q   Median       3Q      Max 
-10226.3    -84.2    -12.6     33.4  12938.9 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           37.11      89.96   0.413    0.680    
bs(FemurCirc, knots = c(35, 50))1   -147.95     247.76  -0.597    0.551    
bs(FemurCirc, knots = c(35, 50))2   2006.70     225.85   8.885   &lt;2e-16 ***
bs(FemurCirc, knots = c(35, 50))3  16223.09     976.41  16.615   &lt;2e-16 ***
bs(FemurCirc, knots = c(35, 50))4  71913.50    1436.65  50.056   &lt;2e-16 ***
bs(FemurCirc, knots = c(35, 50))5 135646.91     728.94 186.087   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 934 on 1030 degrees of freedom
Multiple R-squared:  0.9847,    Adjusted R-squared:  0.9846 
F-statistic: 1.322e+04 on 5 and 1030 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(loglog_BM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="prediction-theropod---back-transform" class="level3">
<h3 class="anchored" data-anchor-id="prediction-theropod---back-transform">Prediction Theropod - back transform</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>Dinos <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'Estimated.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 111 Columns: 29
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(11): Clade.1, Clade.2, Sec_Ref, Primary_Ref, Method, Taxon, EBM.ref.sp,... dbl
(4): BM.g, FemurCirc, FemurLen, Living lgl (14): Clade.3, Pneumatic,
HumerusLen, HumerusCirc, TibulaLen, TibiaCirc,...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `coracoid_HAF_(mm)` -&gt; `coracoid_HAF_(mm)...27`
• `coracoid_HAF_(mm)` -&gt; `coracoid_HAF_(mm)...28`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Dinos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 29
  Clade.1   Clade.2    Clade.3 Sec_Ref Primary_Ref Method Taxon EBM.ref.sp Aves 
  &lt;chr&gt;     &lt;chr&gt;      &lt;lgl&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;
1 Theropoda Allosauro… NA      Campio… Colbert_(1… Physi… Allo… AMNH_275   N    
2 Theropoda Allosauro… NA      Campio… Alexander_… Physi… Allo… AMNH_275   N    
3 Theropoda Allosauro… NA      Campio… Gunga_et_a… Photo… Allo… AMNH_275   N    
4 Theropoda Manirapto… NA      Campio… Paul_(1988) Physi… Stru… AMNH_5339  N    
5 Theropoda Manirapto… NA      Campio… Christians… Physi… Stru… AMNH_5339  N    
6 Theropoda Manirapto… NA      Campio… Henderson_… Slici… Stru… AMNH_5339  N    
# ℹ 20 more variables: BM.g &lt;dbl&gt;, Pneumatic &lt;lgl&gt;, BM.Qual &lt;chr&gt;,
#   Meas.sp &lt;chr&gt;, HumerusLen &lt;lgl&gt;, HumerusCirc &lt;lgl&gt;, FemurCirc &lt;dbl&gt;,
#   FemurLen &lt;dbl&gt;, TibulaLen &lt;lgl&gt;, TibiaCirc &lt;lgl&gt;, TarsusLen &lt;lgl&gt;,
#   TarusCirc &lt;lgl&gt;, Sex &lt;lgl&gt;, Comments &lt;chr&gt;, Living &lt;dbl&gt;,
#   `humerus_diameter_(mm)` &lt;lgl&gt;, `tarsus_diameter_(mm)` &lt;lgl&gt;,
#   `coracoid_HAF_(mm)...27` &lt;lgl&gt;, `coracoid_HAF_(mm)...28` &lt;lgl&gt;,
#   coracoid_max_length &lt;lgl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Dinos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Clade.1"                "Clade.2"                "Clade.3"               
 [4] "Sec_Ref"                "Primary_Ref"            "Method"                
 [7] "Taxon"                  "EBM.ref.sp"             "Aves"                  
[10] "BM.g"                   "Pneumatic"              "BM.Qual"               
[13] "Meas.sp"                "HumerusLen"             "HumerusCirc"           
[16] "FemurCirc"              "FemurLen"               "TibulaLen"             
[19] "TibiaCirc"              "TarsusLen"              "TarusCirc"             
[22] "Sex"                    "Comments"               "Living"                
[25] "humerus_diameter_(mm)"  "tarsus_diameter_(mm)"   "coracoid_HAF_(mm)...27"
[28] "coracoid_HAF_(mm)...28" "coracoid_max_length"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Dinos, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">log</span>(BM.g), <span class="at">x =</span> <span class="fu">log</span>(FemurCirc))) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Method)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.factor</span>(Dinos<span class="sc">$</span>Clade<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] Allosauroidea         Allosauroidea         Allosauroidea        
  [4] Maniraptoriformes     Maniraptoriformes     Maniraptoriformes    
  [7] Tyrannosauroidea      Tyrannosauroidea      Tyrannosauroidea     
 [10] Tyrannosauroidea      Tyrannosauroidea      Tyrannosauroidea     
 [13] Coelurosauria         Coelurosauria         Coelophysoidea       
 [16] Coelophysoidea        Coelophysoidea        Coelophysoidea       
 [19] Coelophysoidea        Coelophysoidea        Tyrannosauroidea     
 [22] Tyrannosauroidea      Maniraptoriformes     Tyrannosauroidea     
 [25] Tyrannosauroidea      Tyrannosauroidea      Tyrannosauroidea     
 [28] Tyrannosauroidea      Tyrannosauroidea      Tyrannosauroidea     
 [31] Tyrannosauroidea      Tyrannosauroidea      Tyrannosauroidea     
 [34] Tyrannosauroidea      Tyrannosauroidea      Tyrannosauroidea     
 [37] Maniraptoriformes     Tyrannosauroidea      Tyrannosauroidea     
 [40] Tyrannosauroidea      Tyrannosauroidea      Tyrannosauroidea     
 [43] Tyrannosauroidea      Maniraptoriformes     Maniraptoriformes    
 [46] Maniraptoriformes     Maniraptoriformes     Maniraptoriformes    
 [49] Ceratosauria          Ceratosauria          Coelophysoidea       
 [52] Maniraptoriformes     Allosauroidea         Allosauroidea        
 [55] Allosauroidea         Maniraptoriformes     Ceratosauria         
 [58] Ceratosauria          Theropoda             Theropoda            
 [61] Maniraptoriformes     Megalosauroidea       Megalosauroidea      
 [64] Tyrannosauroidea      Tyrannosauroidea      Tyrannosauroidea     
 [67] Tyrannosauroidea      Allosauroidea         Carcharodontosauridae
 [70] Carcharodontosauridae Carcharodontosauridae Carcharodontosauridae
 [73] Carcharodontosauridae Carcharodontosauridae Maniraptoriformes    
 [76] Maniraptoriformes     Theropoda             Theropoda            
 [79] Megalosauroidea       Megalosauroidea       Coelophysoidea       
 [82] Coelophysoidea        Coelophysoidea        Tyrannosauroidea     
 [85] Maniraptoriformes     Maniraptoriformes     Maniraptoriformes    
 [88] Theropoda             Theropoda             Ceratosauria         
 [91] Maniraptoriformes     Tyrannosauroidea      Coelophysoidea       
 [94] Coelophysoidea        Coelophysoidea        Coelophysoidea       
 [97] Coelophysoidea        Megalosauroidea       Maniraptoriformes    
[100] Ceratosauria          Ceratosauria          Ceratosauria         
[103] Ceratosauria          Allosauroidea         Allosauroidea        
[106] Maniraptoriformes     Maniraptoriformes     Tyrannosauroidea     
[109] Tyrannosauroidea      Maniraptoriformes     Maniraptoriformes    
9 Levels: Allosauroidea Carcharodontosauridae Ceratosauria ... Tyrannosauroidea</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict VD - Estimated Body Mass</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>Andersonetal1985poly <span class="ot">&lt;-</span>   <span class="fl">0.16</span> <span class="sc">*</span> Dinos<span class="sc">$</span>FemurCirc<span class="sc">^</span><span class="fl">2.37699</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>CampbellMarcus1992 <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.065</span> <span class="sc">+</span> <span class="fl">2.411</span><span class="sc">*</span><span class="fu">log10</span>(Dinos<span class="sc">$</span>FemurCirc))</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>CampioneEtal2014 <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.683</span> <span class="sc">+</span> <span class="fl">2.754</span><span class="sc">*</span><span class="fu">log10</span>(Dinos<span class="sc">$</span>FemurCirc))</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>FieldEtal2013 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.11</span> <span class="sc">+</span> <span class="fl">2.4</span><span class="sc">*</span><span class="fu">log</span>(Dinos<span class="sc">$</span>FemurCirc))</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>RomeroAlarcon2023Log <span class="ot">&lt;-</span>  <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.09121</span> <span class="sc">+</span> <span class="fl">2.37699</span><span class="sc">*</span><span class="fu">log</span>(Dinos<span class="sc">$</span>FemurCirc))</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>RomeroAlarcon2023poly <span class="ot">&lt;-</span> <span class="fu">predict</span>(poly2_BM,<span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">"FemurCirc"</span> <span class="ot">=</span> Dinos<span class="sc">$</span>FemurCirc))</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>modelsPredict1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">trueBM.g =</span> Dinos<span class="sc">$</span>BM.g, <span class="at">FemurCirc =</span> Dinos<span class="sc">$</span>FemurCirc, CampbellMarcus1992, FieldEtal2013, CampioneEtal2014, RomeroAlarcon2023Log, RomeroAlarcon2023poly, Andersonetal1985poly))</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>modelsPredict.BackDinos <span class="ot">&lt;-</span> modelsPredict1 <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(CampbellMarcus1992, FieldEtal2013, CampioneEtal2014, RomeroAlarcon2023Log, RomeroAlarcon2023poly, Andersonetal1985poly), <span class="at">names_to =</span> <span class="st">"Models"</span>, <span class="at">values_to =</span> <span class="st">"predBM.g"</span>)</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> modelsPredict.BackDinos) <span class="sc">+</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> predBM.g, <span class="at">x =</span> FemurCirc, <span class="at">color =</span> Models)) <span class="sc">+</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Dinos,<span class="fu">aes</span>(<span class="at">y =</span> BM.g, <span class="at">x =</span> FemurCirc, <span class="at">shape =</span> Method)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The shape palette can deal with a maximum of 6 discrete values because
more than 6 becomes difficult to discriminate; you have 7. Consider
specifying shapes manually if you must have them.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent prediction error Dinos</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>modelsPPE <span class="ot">&lt;-</span> modelsPredict.BackDinos <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Models) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">PPE =</span> <span class="fu">abs</span>(<span class="fu">as.numeric</span>(trueBM.g) <span class="sc">-</span> <span class="fu">as.numeric</span>(predBM.g))<span class="sc">/</span><span class="fu">as.numeric</span>(predBM.g)<span class="sc">*</span> <span class="dv">100</span>) </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>meansPPE <span class="ot">&lt;-</span> modelsPPE <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Models) <span class="sc">|&gt;</span> <span class="fu">summarize</span>( <span class="at">MPPE =</span> <span class="fu">mean</span>(PPE), <span class="at">sdPPE =</span> <span class="fu">sd</span>(PPE))</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>meansPPE </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Models                  MPPE sdPPE
  &lt;chr&gt;                  &lt;dbl&gt; &lt;dbl&gt;
1 Andersonetal1985poly  1009.  483. 
2 CampbellMarcus1992      80.0  60.7
3 CampioneEtal2014        29.9  26.7
4 FieldEtal2013           83.4  63.4
5 RomeroAlarcon2023Log   101.   76.1
6 RomeroAlarcon2023poly  143.  121. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelsPPE) <span class="sc">+</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Models, <span class="at">y =</span> PPE, <span class="at">group =</span> Models, <span class="at">color =</span> Models))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<pre><code></code></pre>
</section>
<section id="prediction-theropod---transform-log" class="level3">
<h3 class="anchored" data-anchor-id="prediction-theropod---transform-log">Prediction Theropod - transform log</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict VD - Estimated Body Mass transform</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Andersonetal1985poly &lt;-   0.16 * Dinos$FemurCirc^2.37699</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>CampbellMarcus1992 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.065</span> <span class="sc">+</span> <span class="fl">2.411</span><span class="sc">*</span><span class="fu">log10</span>(Dinos<span class="sc">$</span>FemurCirc)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>CampioneEtal2014 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.683</span> <span class="sc">+</span> <span class="fl">2.754</span><span class="sc">*</span><span class="fu">log10</span>(Dinos<span class="sc">$</span>FemurCirc)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>FieldEtal2013 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.11</span> <span class="sc">+</span> <span class="fl">2.4</span><span class="sc">*</span><span class="fu">log</span>(Dinos<span class="sc">$</span>FemurCirc)</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>RomeroAlarcon2023Log <span class="ot">&lt;-</span>  <span class="sc">-</span><span class="fl">0.09121</span> <span class="sc">+</span> <span class="fl">2.37699</span><span class="sc">*</span><span class="fu">log</span>(Dinos<span class="sc">$</span>FemurCirc)</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="co">#RomeroAlarcon2023poly &lt;- predict(poly2_BM,newdata = data.frame("FemurCirc" = Dinos$FemurCirc))</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(Dinos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 111</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>modelsPredictlog10 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">trueBM.g =</span> <span class="fu">log10</span>(Dinos<span class="sc">$</span>BM.g), <span class="at">FemurCirc =</span> <span class="fu">log10</span>(Dinos<span class="sc">$</span>FemurCirc), CampbellMarcus1992, CampioneEtal2014, <span class="at">typeLog =</span> <span class="fu">rep</span>(<span class="st">"log10"</span>, <span class="fu">length</span>(Dinos<span class="sc">$</span>FemurCirc))))</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>modelsPredictlog <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">trueBM.g =</span> <span class="fu">log</span>(Dinos<span class="sc">$</span>BM.g), <span class="at">FemurCirc =</span> <span class="fu">log</span>(Dinos<span class="sc">$</span>FemurCirc),  FieldEtal2013,  RomeroAlarcon2023Log, <span class="at">typeLog =</span> <span class="fu">rep</span>(<span class="st">"log"</span>, <span class="fu">length</span>(Dinos<span class="sc">$</span>FemurCirc))))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>modelsPredictlog10 <span class="ot">&lt;-</span> modelsPredictlog10 <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(CampbellMarcus1992, CampioneEtal2014), <span class="at">names_to =</span> <span class="st">"Models"</span>, <span class="at">values_to =</span> <span class="st">"predBM.g"</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>modelsPredictlog <span class="ot">&lt;-</span> modelsPredictlog <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>( FieldEtal2013,  RomeroAlarcon2023Log), <span class="at">names_to =</span> <span class="st">"Models"</span>, <span class="at">values_to =</span> <span class="st">"predBM.g"</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>modelsPredict.DinoLog <span class="ot">&lt;-</span> <span class="fu">rbind</span>(modelsPredictlog, modelsPredictlog10)</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(modelsPredict.DinoLog <span class="sc">$</span>Models))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CampbellMarcus1992"   "CampioneEtal2014"     "FieldEtal2013"       
[4] "RomeroAlarcon2023Log"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> modelsPredict.DinoLog ) <span class="sc">+</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(trueBM.g), <span class="at">x =</span> <span class="fu">as.numeric</span>(FemurCirc), <span class="at">color =</span> Models), <span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(trueBM.g), <span class="at">x =</span> <span class="fu">as.numeric</span>(FemurCirc))) <span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(typeLog <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">'free'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent prediction error Dinos</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>modelsPPE <span class="ot">&lt;-</span> modelsPredict.DinoLog  <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Models) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">PPE =</span> <span class="fu">abs</span>(<span class="fu">as.numeric</span>(trueBM.g) <span class="sc">-</span> <span class="fu">as.numeric</span>(predBM.g))<span class="sc">/</span><span class="fu">as.numeric</span>(predBM.g)<span class="sc">*</span> <span class="dv">100</span>) </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>meansPPE <span class="ot">&lt;-</span> modelsPPE <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Models) <span class="sc">|&gt;</span> <span class="fu">summarize</span>( <span class="at">MPPE =</span> <span class="fu">mean</span>(PPE), <span class="at">sdPPE =</span> <span class="fu">sd</span>(PPE))</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>meansPPE </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  Models                MPPE sdPPE
  &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt;
1 CampbellMarcus1992    4.24  2.24
2 CampioneEtal2014      2.36  2.09
3 FieldEtal2013         4.35  2.28
4 RomeroAlarcon2023Log  4.93  2.53</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelsPPE) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Models, <span class="at">y =</span> PPE, <span class="at">group =</span> Models, <span class="at">color =</span> Models))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="palaeognathae-prediction---back-transform" class="level3">
<h3 class="anchored" data-anchor-id="palaeognathae-prediction---back-transform">Palaeognathae prediction - Back transform</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Palaeognathae prediction</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>palaeognathae <span class="ot">&lt;-</span> newAves <span class="sc">|&gt;</span> <span class="fu">filter</span>(Clade<span class="fl">.1</span> <span class="sc">==</span> <span class="st">"Palaeognathae"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(BM.g) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(FemurCirc))</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.factor</span>(palaeognathae<span class="sc">$</span>Clade<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Tinamiformes     Tinamiformes     Tinamiformes     Casuariiformes  
 [5] Tinamiformes     Tinamiformes     Rheiformes       Struthioniformes
 [9] Tinamiformes     Tinamiformes     Apterygiformes   Tinamiformes    
[13] Casuariiformes   Rheiformes       Casuariiformes   Casuariiformes  
[17] Struthioniformes Struthioniformes Struthioniformes Struthioniformes
5 Levels: Apterygiformes Casuariiformes Rheiformes ... Tinamiformes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> newAves) <span class="sc">+</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> BM.g, <span class="at">x =</span> FemurCirc, )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict VD - Estimated Body Mass</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>Andersonetal1985poly <span class="ot">&lt;-</span>   <span class="fl">0.16</span> <span class="sc">*</span> palaeognathae<span class="sc">$</span>FemurCirc<span class="sc">^</span><span class="fl">2.37699</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>CampbellMarcus1992 <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.065</span> <span class="sc">+</span> <span class="fl">2.411</span><span class="sc">*</span><span class="fu">log10</span>(palaeognathae<span class="sc">$</span>FemurCirc))</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>CampioneEtal2014 <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.683</span> <span class="sc">+</span> <span class="fl">2.754</span><span class="sc">*</span><span class="fu">log10</span>(palaeognathae<span class="sc">$</span>FemurCirc))</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>FieldEtal2013 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.11</span> <span class="sc">+</span> <span class="fl">2.4</span><span class="sc">*</span><span class="fu">log</span>(palaeognathae<span class="sc">$</span>FemurCirc))</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>RomeroAlarcon2023Log <span class="ot">&lt;-</span>  <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.09121</span> <span class="sc">+</span> <span class="fl">2.37699</span><span class="sc">*</span><span class="fu">log</span>(palaeognathae<span class="sc">$</span>FemurCirc))</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>RomeroAlarcon2023poly <span class="ot">&lt;-</span> <span class="fu">predict</span>(poly2_BM,<span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="st">"FemurCirc"</span> <span class="ot">=</span> palaeognathae<span class="sc">$</span>FemurCirc))</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>modelsPredict1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">trueBM.g =</span> palaeognathae<span class="sc">$</span>BM.g, <span class="at">FemurCirc =</span> palaeognathae<span class="sc">$</span>FemurCirc, CampbellMarcus1992, FieldEtal2013, CampioneEtal2014, RomeroAlarcon2023Log, RomeroAlarcon2023poly,Andersonetal1985poly))</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>modelsPredict.backPalae <span class="ot">&lt;-</span> modelsPredict1 <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(CampbellMarcus1992, FieldEtal2013, CampioneEtal2014, RomeroAlarcon2023Log, RomeroAlarcon2023poly,Andersonetal1985poly), <span class="at">names_to =</span> <span class="st">"Models"</span>, <span class="at">values_to =</span> <span class="st">"predBM.g"</span>)</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(modelsPredict.backPalae<span class="sc">$</span>Models))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Andersonetal1985poly"  "CampbellMarcus1992"    "CampioneEtal2014"     
[4] "FieldEtal2013"         "RomeroAlarcon2023Log"  "RomeroAlarcon2023poly"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> modelsPredict.backPalae) <span class="sc">+</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> predBM.g, <span class="at">x =</span> FemurCirc, <span class="at">color =</span> Models)) <span class="sc">+</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> palaeognathae,<span class="fu">aes</span>(<span class="at">y =</span> BM.g, <span class="at">x =</span> FemurCirc)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent prediction error Dinos</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>modelsPPE <span class="ot">&lt;-</span> modelsPredict.backPalae  <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Models) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">PPE =</span> <span class="fu">abs</span>(<span class="fu">as.numeric</span>(trueBM.g) <span class="sc">-</span> <span class="fu">as.numeric</span>(predBM.g))<span class="sc">/</span><span class="fu">as.numeric</span>(predBM.g)<span class="sc">*</span> <span class="dv">100</span>) </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>meansPPE <span class="ot">&lt;-</span> modelsPPE <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Models) <span class="sc">|&gt;</span> <span class="fu">summarize</span>( <span class="at">MPPE =</span> <span class="fu">mean</span>(PPE), <span class="at">sdPPE =</span> <span class="fu">sd</span>(PPE))</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>meansPPE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Models                 MPPE sdPPE
  &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt;
1 Andersonetal1985poly  473.  252. 
2 CampbellMarcus1992     25.9  33.5
3 CampioneEtal2014       39.6  65.5
4 FieldEtal2013          26.0  33.0
5 RomeroAlarcon2023Log   25.4  35.8
6 RomeroAlarcon2023poly  43.0  74.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelsPPE) <span class="sc">+</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Models, <span class="at">y =</span> PPE, <span class="at">group =</span> Models, <span class="at">color =</span> Models))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="palaeognathae---no-back-transform" class="level3">
<h3 class="anchored" data-anchor-id="palaeognathae---no-back-transform">Palaeognathae - No back transform</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict VD - Estimated Body Mass no transform</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Andersonetal1985poly &lt;-   0.16 * Dinos$FemurCirc^2.37699</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>CampbellMarcus1992 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.065</span> <span class="sc">+</span> <span class="fl">2.411</span><span class="sc">*</span><span class="fu">log10</span>(palaeognathae<span class="sc">$</span>FemurCirc)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>CampioneEtal2014 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.683</span> <span class="sc">+</span> <span class="fl">2.754</span><span class="sc">*</span><span class="fu">log10</span>(palaeognathae<span class="sc">$</span>FemurCirc)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>FieldEtal2013 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.11</span> <span class="sc">+</span> <span class="fl">2.4</span><span class="sc">*</span><span class="fu">log</span>(palaeognathae<span class="sc">$</span>FemurCirc)</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>RomeroAlarcon2023Log <span class="ot">&lt;-</span>  <span class="sc">-</span><span class="fl">0.09121</span> <span class="sc">+</span> <span class="fl">2.37699</span><span class="sc">*</span><span class="fu">log</span>(palaeognathae<span class="sc">$</span>FemurCirc)</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="co">#RomeroAlarcon2023poly &lt;- predict(poly2_BM,newdata = data.frame("FemurCirc" = Dinos$FemurCirc))</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>modelsPredictlog10 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">trueBM.g =</span> <span class="fu">log10</span>(palaeognathae<span class="sc">$</span>BM.g), <span class="at">FemurCirc =</span> <span class="fu">log10</span>(palaeognathae<span class="sc">$</span>FemurCirc), CampbellMarcus1992, CampioneEtal2014, <span class="at">typeLog =</span> <span class="fu">rep</span>(<span class="st">"log10"</span>, <span class="fu">length</span>(palaeognathae<span class="sc">$</span>FemurCirc))))</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>modelsPredictlog <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">trueBM.g =</span> <span class="fu">log</span>(palaeognathae<span class="sc">$</span>BM.g), <span class="at">FemurCirc =</span> <span class="fu">log</span>(palaeognathae<span class="sc">$</span>FemurCirc),  FieldEtal2013,  RomeroAlarcon2023Log, <span class="at">typeLog =</span> <span class="fu">rep</span>(<span class="st">"log"</span>, <span class="fu">length</span>(palaeognathae<span class="sc">$</span>FemurCirc))))</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>modelsPredictlog10 <span class="ot">&lt;-</span> modelsPredictlog10 <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(CampbellMarcus1992, CampioneEtal2014), <span class="at">names_to =</span> <span class="st">"Models"</span>, <span class="at">values_to =</span> <span class="st">"predBM.g"</span>)</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>modelsPredictlog <span class="ot">&lt;-</span> modelsPredictlog <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>( FieldEtal2013,  RomeroAlarcon2023Log), <span class="at">names_to =</span> <span class="st">"Models"</span>, <span class="at">values_to =</span> <span class="st">"predBM.g"</span>)</span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>modelsPredict.logPalae <span class="ot">&lt;-</span> <span class="fu">rbind</span>(modelsPredictlog, modelsPredictlog10)</span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(modelsPredict.logPalae <span class="sc">$</span>Models))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CampbellMarcus1992"   "CampioneEtal2014"     "FieldEtal2013"       
[4] "RomeroAlarcon2023Log"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> modelsPredict.logPalae ) <span class="sc">+</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(trueBM.g), <span class="at">x =</span> <span class="fu">as.numeric</span>(FemurCirc), <span class="at">color =</span> Models), <span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(trueBM.g), <span class="at">x =</span> <span class="fu">as.numeric</span>(FemurCirc))) <span class="sc">+</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(typeLog <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">'free'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent prediction error Palae</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>modelsPPE <span class="ot">&lt;-</span> modelsPredict.logPalae  <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Models) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">PPE =</span> <span class="fu">abs</span>(<span class="fu">as.numeric</span>(trueBM.g) <span class="sc">-</span> <span class="fu">as.numeric</span>(predBM.g))<span class="sc">/</span><span class="fu">as.numeric</span>(predBM.g)<span class="sc">*</span> <span class="dv">100</span>) </span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>meansPPE <span class="ot">&lt;-</span> modelsPPE <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Models) <span class="sc">|&gt;</span> <span class="fu">summarize</span>( <span class="at">MPPE =</span> <span class="fu">mean</span>(PPE), <span class="at">sdPPE =</span> <span class="fu">sd</span>(PPE))</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>meansPPE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  Models                MPPE sdPPE
  &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt;
1 CampbellMarcus1992    3.55  4.03
2 CampioneEtal2014      4.35  5.14
3 FieldEtal2013         3.60  4.03
4 RomeroAlarcon2023Log  3.32  4.07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelsPPE) <span class="sc">+</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Models, <span class="at">y =</span> PPE, <span class="at">group =</span> Models, <span class="at">color =</span> Models))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plot-presentation" class="level3">
<h3 class="anchored" data-anchor-id="plot-presentation">Plot presentation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(new<span class="sc">$</span>Sec_Ref))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Campione_&amp;_Evans_2020"      "Campione_et_al_(2014)"     
[3] "Canoville_etal_(2022)"      "Chadwick_et_al_(2014)"     
[5] "Chan_(2017)"                "Crouch&amp;Clarke_(2019)"      
[7] "Elzanowski&amp;Louchart_(2022)" "Field_et_al_(2013)"        
[9] "Gatesy&amp;Middleton_(1997)"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>plotIntro <span class="ot">&lt;-</span> new <span class="sc">|&gt;</span> <span class="fu">filter</span>(Aves <span class="sc">==</span> <span class="st">"Y"</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Ref =</span> <span class="fu">ifelse</span>( Sec_Ref <span class="sc">==</span> <span class="st">"Campione_et_al_(2014)"</span>, <span class="st">"Campione_et_al_2014"</span>, <span class="fu">ifelse</span>( Sec_Ref <span class="sc">==</span> <span class="st">"Field_et_al_(2013)"</span>,<span class="st">"Field_et_al_2013"</span>, <span class="fu">ifelse</span>( typeFC <span class="sc">==</span> <span class="st">"Predicted"</span>, <span class="st">"NewSource"</span>, <span class="st">"NewSource"</span>)))) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(BM.g) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(FemurCirc)) <span class="sc">|&gt;</span> <span class="fu">filter</span>(Ref <span class="sc">!=</span> <span class="st">"NewSource"</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot FC ~ FL</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotIntro, <span class="fu">aes</span>(<span class="at">x =</span> FemurCirc, <span class="at">y =</span> BM.g)) <span class="sc">+</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>( <span class="at">color =</span> Ref, <span class="at">shape =</span> Clade<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Ref <span class="sc">~</span> .)<span class="sc">+</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin=</span><span class="dv">8</span>, <span class="at">xmax=</span><span class="dv">100</span>, <span class="at">ymin=</span><span class="fl">0.8</span>, <span class="at">ymax=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>